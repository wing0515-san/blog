<footer class="{{ .Site.Params.base_color }} text-white p-6">
  {{ if .Site.Menus.foot }}
  <div class="flex justify-center w-full md:flex md:flex-row sm:items-center sm:w-auto mb-4">
    <div>
      {{ range .Site.Menus.foot }}
      <a href="{{ .URL }}" class="no-underline block sm:inline-block duration-200 text-white hover:opacity-50">
        {{ .Name }}
      </a>
      {{ end }}
    </div>
  </div>
  {{ end }}
  <div class="container max-w-screen-xl mr-auto ml-auto">
    <p>&copy; {{ now.Year }} <a href="{{ .Site.BaseURL }}" class="duration-200 hover:opacity-50">{{ .Site.Title }}</a>
    </p>
    <p>Powered by <a href="https://gohugo.io/" class="duration-200 hover:opacity-50">Hugo</a>, Theme <a
        href="https://github.com/opera7133/Blonde" class="duration-200 hover:opacity-50">Blonde</a>.</p>
  </div>
  {{ if .Site.Params.ad.googleAdSense }}
  <script>
    (function (window, document) {
      function main() {
        var ad = document.createElement('script');
        ad.async = true;
        ad.src = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client={{ .Site.Params.ad.googleAdSense }}';
        ad.crossOrigin = "anonymous"
        var sc = document.getElementsByTagName('script')[0];
        sc.parentNode.insertBefore(ad, sc);
      }

      var lazyLoad = false;
      function onLazyLoad() {
        if (lazyLoad === false) {
          lazyLoad = true;
          window.removeEventListener('scroll', onLazyLoad);
          window.removeEventListener('mousemove', onLazyLoad);
          window.removeEventListener('mousedown', onLazyLoad);
          window.removeEventListener('touchstart', onLazyLoad);
          window.removeEventListener('keydown', onLazyLoad);
          main();
        }
      }
      window.addEventListener('scroll', onLazyLoad);
      window.addEventListener('mousemove', onLazyLoad);
      window.addEventListener('mousedown', onLazyLoad);
      window.addEventListener('touchstart', onLazyLoad);
      window.addEventListener('keydown', onLazyLoad);
      window.addEventListener('load', function () {
        if (window.pageYOffset) {
          onLazyLoad();
          window.setTimeout(onLazyLoad, 3000)
        }
      });
    })(window, document);
  </script>
  {{ end }}
  <script>
    var icon = document.getElementById("icon");
    var icon2 = document.getElementById("icon2");
    // On page load or when changing themes, best to add inline in `head` to avoid FOUC
    if (document.documentElement.classList.contains("dark") || localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      icon.classList.remove("icon-moon");
      icon.classList.add("icon-sun");
      icon2.classList.remove("icon-moon");
      icon2.classList.add("icon-sun");
      document.documentElement.classList.add('dark')
    } else {
      document.documentElement.classList.remove('dark')
    }
    function toggleDarkMode() {
      if (document.documentElement.classList.contains('dark')) {
        icon.classList.remove("icon-sun");
        icon.classList.add("icon-moon");
        icon2.classList.remove("icon-sun");
        icon2.classList.add("icon-moon");
        document.documentElement.classList.remove('dark')
        localStorage.theme = 'light'
      } else {
        icon.classList.remove("icon-moon");
        icon.classList.add("icon-sun");
        icon2.classList.remove("icon-moon");
        icon2.classList.add("icon-sun");
        document.documentElement.classList.add('dark')
        localStorage.theme = 'dark'
      }
    }
      // 加载 search.json 文件
    async function search() {
      const response = await fetch('/search.json');
      const data = await response.json();

      // 设置 Fuse.js 搜索选项
      const options = {
        keys: ['title', 'summary', 'content'],  // 设定可以搜索的字段
        threshold: 0.3  // 搜索精度，越低越精确
      };

      const fuse = new Fuse(data, options);

      // 获取输入框和搜索结果的容器
      const searchInput = document.getElementById('searchInput');
      const searchResults = document.getElementById('searchResults');

      // 搜索输入框监听输入事件
      searchInput.addEventListener('input', function() {
        const query = searchInput.value;
        const results = fuse.search(query);  // 使用 Fuse.js 搜索

        // 清空之前的搜索结果
        searchResults.innerHTML = '';

        // 展示搜索结果
        if (results.length > 0) {
          results.forEach(result => {
            const item = document.createElement('div');
            item.innerHTML = `
              <a href="${result.item.permalink}">
                <h2 class="font-bold text-lg">${result.item.title}</h2>
                <p>${result.item.summary}</p>
              </a>
            `;
            searchResults.appendChild(item);
          });
        } else {
          searchResults.innerHTML = '<p>No results found</p>';
        }
      });
    }

    // 初始化搜索功能
    search();
  </script>
</footer>